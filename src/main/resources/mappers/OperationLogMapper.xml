<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.pubbyserver.dao.OperationLogDao">

    <resultMap id="OperationLogResultMap" type="com.example.pubbyserver.entity.OperationLogEntity">
        <id property="id" column="id"/>
        <result property="operationModule" column="operation_module"/>
        <result property="operationType" column="operation_type"/>
        <result property="operator" column="operator"/>
        <result property="operationTime" column="operation_time"/>
        <result property="ipAddress" column="ip_address"/>
        <result property="executionTime" column="execution_time"/>
        <result property="status" column="status"/>
    </resultMap>

    <insert id="insertOperationLog" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO operation_log(operation_module, operation_type, operator, operation_time, ip_address, execution_time, status)
        VALUES(#{operationModule}, #{operationType}, #{operator}, #{operationTime}, #{ipAddress}, #{executionTime}, #{status})
    </insert>

    <select id="getOperationLogById" resultMap="OperationLogResultMap" parameterType="long">
        SELECT * FROM operation_log WHERE id = #{id}
    </select>

    <select id="getAllOperationLogs" resultMap="OperationLogResultMap">
        SELECT * FROM operation_log ORDER BY operation_time DESC
    </select>

    <select id="getOperationLogsByModule" resultMap="OperationLogResultMap" parameterType="string">
        SELECT * FROM operation_log WHERE operation_module = #{module} ORDER BY operation_time DESC
    </select>

    <select id="getOperationLogsByOperator" resultMap="OperationLogResultMap" parameterType="string">
        SELECT * FROM operation_log WHERE operator = #{operator} ORDER BY operation_time DESC
    </select>

    <select id="getOperationLogsByType" resultMap="OperationLogResultMap" parameterType="string">
        SELECT * FROM operation_log WHERE operation_type = #{type} ORDER BY operation_time DESC
    </select>

</mapper>